# Windows系统启动和疑难解答

本文档提供在Windows系统上启动和运行飞书多维表格插件的详细指南以及常见问题的解决方法。

## 启动纯前端应用（推荐）

由于应用已经重构为纯前端实现，不再需要后端服务器，因此推荐使用以下方法启动：

### 方法一：使用批处理脚本

1. 打开命令提示符或PowerShell
2. 导航到项目根目录
3. 运行批处理脚本：
   ```
   run-windows.bat
   ```

### 方法二：直接使用npx vite

1. 打开命令提示符或PowerShell
2. 导航到项目根目录
3. 运行命令：
   ```
   npx vite --host 0.0.0.0
   ```

## 可能遇到的问题和解决方案

### 问题1：端口绑定错误 (ENOTSUP)

**症状**：
```
Error: listen ENOTSUP: operation not supported on socket 0.0.0.0:5000
```

**解决方案**：
这个错误通常出现在尝试使用旧的后端服务器时。由于我们已经重构为纯前端实现，请使用上面推荐的纯前端启动方法，不要使用`npm run dev`或`tsx server/index.ts`。

### 问题2：NPM模块或命令未找到

**症状**：
```
'vite' 不是内部或外部命令，也不是可运行的程序或批处理文件。
```

**解决方案**：
1. 确保已经安装了所有依赖：
   ```
   npm install
   ```
2. 尝试使用完整路径：
   ```
   node_modules\.bin\vite
   ```
3. 或者使用npx确保使用本地安装的vite：
   ```
   npx vite
   ```

### 问题3：TypeScript类型错误导致构建失败

**症状**：
构建过程中出现TypeScript类型错误。

**解决方案**：
这些错误通常是与飞书SDK类型定义兼容性有关的警告，在大多数情况下不会影响应用的实际运行。如果需要忽略这些错误以便构建成功，可以：

1. 创建一个`.env`文件，添加：
   ```
   VITE_SKIP_TS_CHECK=true
   ```

2. 或者在命令行中使用：
   ```
   set VITE_SKIP_TS_CHECK=true && npx vite
   ```

### 问题4：飞书SDK相关错误

**症状**：
```
Error: 飞书多维表格SDK未找到
```

**解决方案**：
这是正常的，因为在本地开发环境中无法完全模拟飞书多维表格环境。应用包含了错误处理，会显示友好的错误信息。在实际部署到飞书多维表格插件时，这个错误不会出现。

如果需要在本地进行更完整的测试，可以考虑创建一个简单的模拟层来模拟飞书SDK的行为。

## 部署和发布

当应用准备好发布时，使用以下命令构建：

```
npx vite build
```

构建完成后，`dist`目录中的文件即可用于部署到飞书开放平台。

## 获取帮助

如果遇到未在此文档中列出的问题，请：

1. 查看错误日志获取更多信息
2. 检查控制台输出的详细错误信息
3. 参考飞书开发者文档：https://open.feishu.cn/document/home/introduction-to-the-base/introduction
4. 在项目仓库中提交issue

## 补充说明

- 此插件是一个纯前端实现，所有API操作和数据存储都通过飞书多维表格SDK完成
- 在本地开发环境中，某些功能由于无法访问真实的飞书环境而无法完全测试
- 最终部署需要在飞书开发者平台创建应用并设置多维表格插件功能